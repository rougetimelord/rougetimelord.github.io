var swap=function(b){var a=new XMLHttpRequest;a.open("GET",b,!0);a.timeout=4E3;a.onload=function(){200==a.status||304==a.status?(document.getElementsByClassName("main")[0].innerHTML=a.responseText,addXHR()):console.log(a.status)};a.send()},addXHR=function(){var b=document.getElementsByClassName("xhr");if(history.pushState&&0!=b.length)for(var a=0;a<b.length;a++){var e=b[a];e.addEventListener("click",function(a){a.preventDefault();swap(e.href)},!1)}},runStar=function(){var b=document.getElementById("back"),
a=new Starfield;a.initialise(b);a.start()},song=function(){function b(a){console.log(a)}window.AudioContext||(window.webkitAudioContext||alert("No audiocontext found"),window.AudioContext=window.webkitAudioContext);var a=new AudioContext,e,f,g,k=0,l=["never-met","still-high","dark","fuck-boy"],m=[],n=function(){for(var a=-1;a!==k&&0>=a;)a=Math.floor(Math.random()*l.length);k=a;a=m[k];e.buffer=a;a=Math.floor(1E3*a.duration);e.start(0);setTimeout(n,a)};e=a.createBufferSource();g=a.createScriptProcessor(2048,
1,1);g.connect(a.destination);f=a.createAnalyser();f.smoothingTimeConstant=.3;f.fftSize=1024;e.connect(f);f.connect(g);e.connect(a.destination);(function(){for(var h=0;h<l.length;h++){var c=new XMLHttpRequest;c.open("GET",url,!0);c.responseType="arraybuffer";src="./Content/"+l[h]+".mp3";c.onload=function(){a.decodeAudioData(c.response,function(a){m.append(a)},b)};c.send()}n()})();g.onaudioprocess=function(){var a=new Uint8Array(f.frequencyBinCount);f.getByteFrequencyData(a);for(var c=0,d=a.length,
b=0;b<d;b++)c+=a[b];a=c/d;c=document.getElementsByClassName("react");for(d=0;d<c.length;d++)c[d].classList.remove("light");if(50<=a)for(d=0;d<c.length;d++)c[d].classList.add("light")}};document.addEventListener("DOMContentLoaded",function(){addXHR();runStar();song()});
