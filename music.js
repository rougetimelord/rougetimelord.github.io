var song=function(){function r(a){var c=this;c.request=new XMLHttpRequest;c.request.open("GET",a,!0);c.request.responseType="arraybuffer";c.request.onload=function(){b.decodeAudioData(c.request.response,function(a){m&&(m=!1,new n(a));h.push(a);h.length<k.length&&(f++,f<k.length||(f=0),p(f))})};c.request.send()}function n(a){this.source=b.createBufferSource();this.source.connect(e);this.source.connect(g);this.source.buffer=a;this.duration=Math.floor(1E3*a.duration);this.source.start(0);setTimeout(q,this.duration)}if(!window.AudioContext){if(!window.webkitAudioContext){var d=document.createElement("audio");d.src="./Content/fuck-boy.mp3";d.autoplay=!0;d.loop=!0;return document.body.appendChild(d)}window.AudioContext=window.webkitAudioContext}var b=new AudioContext,m=!0,h=[],l=0,k=["never-met","still-high","dark","fuck-boy"],q=function(){l=Math.floor(Math.random()*h.length);m?(l=Math.floor(Math.random()*k.length),p(l)):new n(h[l])},f=0,p=function(a){var c="./Content/"+k[a]+".mp3";f=a;new r(c)};d=b.createScriptProcessor(2048,1,1);d.connect(b.destination);var e=b.createAnalyser();e.smoothingTimeConstant=.3;e.fftSize=1024;e.connect(d);var g=b.createGain();g.gain.setValueAtTime(.35,b.currentTime);g.connect(b.destination);q();d.onaudioprocess=function(){var a=new Uint8Array(e.frequencyBinCount);e.getByteFrequencyData(a);for(var c=0,b=a.length,d=0;d<b;d++)c+=a[d];c/=b;a=document.getElementsByClassName("react");for(b=0;b<a.length;b++)a[b].classList.remove("light");if(70<=c)for(c=0;c<a.length;c++)a[c].classList.add("light")};window.addEventListener("focus",function(){g.gain.linearRampToValueAtTime(.35,b.currentTime+.3)});window.addEventListener("blur",function(){g.gain.linearRampToValueAtTime(.03,b.currentTime+1.2)})};